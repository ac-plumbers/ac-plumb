---
import ServicesLayout from '@/layouts/ServicesLayout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

// Get all services and sort (featured first, then alphabetically)
const allServices = await getCollection('services');
const services = allServices.sort((a, b) => {
  // Sort featured services first
  if (a.data.featured && !b.data.featured) return -1;
  if (!a.data.featured && b.data.featured) return 1;
  // Then sort alphabetically
  return a.data.title.localeCompare(b.data.title);
});

// Separate featured services
const featuredServices = services.filter(service => service.data.featured);
---

<ServicesLayout>
  <div class='bg-white'>
    <!-- Hero Section -->
    <div class='relative bg-gradient-to-r from-blue-700 to-blue-500 text-white'>
      <div class='mx-auto max-w-7xl px-4 py-24 sm:px-6 lg:px-8'>
        <div class='text-center'>
          <h1 class='text-4xl font-bold tracking-tight sm:text-5xl md:text-6xl'>
            Our Professional Services
          </h1>
          <p class='mx-auto mt-6 max-w-2xl text-xl text-blue-100'>
            Comprehensive plumbing solutions delivered with expertise and care
            across Brighton & Hove
          </p>
        </div>
      </div>
      <!-- Decorative wave pattern -->
      <div class='absolute inset-x-0 bottom-0'>
        <svg
          xmlns='http://www.w3.org/2000/svg'
          viewBox='0 0 1440 320'
          class='w-full h-16 text-white fill-current'>
          <path
            d='M0,128L48,144C96,160,192,192,288,186.7C384,181,480,139,576,133.3C672,128,768,160,864,176C960,192,1056,192,1152,170.7C1248,149,1344,107,1392,85.3L1440,64L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'
          ></path>
        </svg>
      </div>
    </div>

    <!-- Introduction -->
    <div class='mx-auto max-w-7xl px-4 py-12 sm:px-6 lg:px-8'>
      <div class='prose prose-lg mx-auto text-center text-gray-600'>
        <p>
          With over 20 years of experience, AC Plumbing delivers exceptional
          service for all your plumbing, heating, and renewable energy needs.
          Our certified professionals ensure quality workmanship and customer
          satisfaction on every job, whether it's an emergency repair or a
          complete system installation.
        </p>
      </div>
    </div>

    <!-- Featured Services Section -->
    {
      featuredServices.length > 0 && (
        <div class='bg-gray-50 py-12'>
          <div class='mx-auto max-w-7xl px-4 sm:px-6 lg:px-8'>
            <h2 class='text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl text-center mb-12'>
              Featured Services
            </h2>
            <div class='grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3'>
              {featuredServices.map(service => (
                <a
                  href={`/services/${service.slug}`}
                  class='group relative overflow-hidden rounded-lg bg-white shadow-md transition-all hover:shadow-lg'>
                  <div class='aspect-h-2 aspect-w-3 overflow-hidden'>
                    {service.data.image ? (
                      <img
                        src={service.data.image}
                        alt={service.data.title}
                        class='h-full w-full object-cover object-center group-hover:opacity-75'
                      />
                    ) : (
                      <div class='h-48 w-full bg-blue-100 flex items-center justify-center'>
                        <svg
                          xmlns='http://www.w3.org/2000/svg'
                          fill='none'
                          viewBox='0 0 24 24'
                          stroke-width='1.5'
                          stroke='currentColor'
                          class='w-12 h-12 text-blue-400'>
                          <path
                            stroke-linecap='round'
                            stroke-linejoin='round'
                            d='M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z'
                          />
                        </svg>
                      </div>
                    )}
                    <div class='absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity' />
                  </div>
                  <div class='p-6'>
                    <h3 class='text-xl font-semibold text-gray-900 group-hover:text-blue-600'>
                      {service.data.title}
                    </h3>
                    <p class='mt-2 text-gray-600 line-clamp-3'>
                      {service.data.description}
                    </p>
                    <div class='mt-4 flex items-center justify-between'>
                      <span class='text-blue-600'>Learn more</span>
                      {service.data.price && (
                        <span class='text-sm font-medium text-gray-900'>
                          From £{service.data.price}
                        </span>
                      )}
                    </div>
                  </div>
                </a>
              ))}
            </div>
          </div>
        </div>
      )
    }

    <!-- All Services -->
    <div class='mx-auto max-w-7xl px-4 py-16 sm:px-6 lg:px-8'>
      <h2 class='text-3xl font-bold text-gray-900 mb-8'>All Services</h2>
      <div
        class='grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-2 lg:grid-cols-3'>
        {
          services.map(service => (
            <a href={`/services/${service.slug}`} class='group block'>
              <div class='overflow-hidden rounded-lg bg-gray-100 p-6 shadow-sm transition-all hover:bg-blue-50 hover:shadow'>
                <div class='flex items-center justify-between mb-4'>
                  <div class='w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center'>
                    <svg
                      xmlns='http://www.w3.org/2000/svg'
                      fill='none'
                      viewBox='0 0 24 24'
                      stroke-width='1.5'
                      stroke='currentColor'
                      class='w-6 h-6 text-blue-600'>
                      <path
                        stroke-linecap='round'
                        stroke-linejoin='round'
                        d='M21.75 6.75a4.5 4.5 0 01-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 11-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 016.336-4.486l-3.276 3.276a3.004 3.004 0 002.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852z'
                      />
                      <path
                        stroke-linecap='round'
                        stroke-linejoin='round'
                        d='M4.867 19.125h.008v.008h-.008v-.008z'
                      />
                    </svg>
                  </div>
                  {service.data.price && (
                    <div class='text-sm text-gray-500'>
                      From{' '}
                      <span class='font-semibold text-gray-900'>
                        £{service.data.price}
                      </span>
                    </div>
                  )}
                </div>
                <h3 class='text-lg font-medium text-gray-900 group-hover:text-blue-700'>
                  {service.data.title}
                </h3>
                <p class='mt-2 text-sm text-gray-600 line-clamp-2'>
                  {service.data.description}
                </p>
                {service.data.tags && service.data.tags.length > 0 && (
                  <div class='mt-4 flex flex-wrap gap-2'>
                    {service.data.tags.slice(0, 3).map(tag => (
                      <span class='inline-flex items-center rounded-full bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700'>
                        {tag}
                      </span>
                    ))}
                  </div>
                )}
              </div>
            </a>
          ))
        }
      </div>
    </div>

    <!-- Call to Action -->
    <div class='bg-blue-700 text-white'>
      <div class='mx-auto max-w-7xl px-4 py-16 sm:px-6 lg:px-8'>
        <div class='lg:flex lg:items-center lg:justify-between'>
          <h2 class='text-3xl font-bold tracking-tight sm:text-4xl'>
            Ready to schedule your service?
            <span class='block text-blue-200'
              >Get in touch with our team today.</span
            >
          </h2>
          <div class='mt-8 flex flex-shrink-0 lg:mt-0 lg:ml-8'>
            <a
              href='/contact'
              class='inline-flex rounded-md bg-white px-6 py-3 text-base font-medium text-blue-700 shadow hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-blue-700'>
              Request a Quote
            </a>
            <a
              href='tel:+441234567890'
              class='ml-4 inline-flex items-center rounded-md border border-white bg-transparent px-6 py-3 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-blue-700'>
              Call Us
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</ServicesLayout>
